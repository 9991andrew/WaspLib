(*
RSZoom
======
Methods to handle the zoom levels.
*)

{$DEFINE WL_RSZOOM_INCLUDED}
{$IFNDEF WL_OSR}
  {$I WaspLib/osr.simba}
{$ENDIF}

type
  TRSZoomLevel = record
    Start: Double;
    Stop: Double;
  end;

  TRSZoomToSlider = record
    TrueZoom: Double;
    Slider: Int32;
  end;

  TRSZoomLevelArray = array of TRSZoomLevel;

  TRSZoom = record(TSRLBaseRecord)
    MM2MSZoomLevel: ^Int32;
    TrueZoomLevel: Double;
  class const
    TRUE_ZOOM_IN  : TRSZoomLevelArray = [[1448,1349], [1444,1346], [1440,1342], [1436,1338], [1432,1335], [1428,1331], [1424,1327], [1420,1324], [1417,1320], [1413,1317], [1409,1313], [1405,1310], [1401,1306], [1398,1303], [1394,1299], [1390,1295], [1386,1292], [1383,1288], [1379,1285], [1375,1282], [1371,1278], [1368,1275], [1364,1271], [1360,1268], [1357,1264], [1353,1261], [1349,1257], [1346,1254], [1342,1251], [1338,1247], [1335,1244], [1331,1241], [1327,1237], [1324,1234], [1320,1231], [1317,1227], [1313,1224], [1310,1221], [1306,1217], [1303,1214], [1299,1211], [1295,1207], [1292,1204], [1288,1201], [1285,1198], [1282,1194], [1278,1191], [1275,1188], [1271,1185], [1268,1182], [1264,1178], [1261,1175], [1257,1172], [1254,1169], [1251,1166], [1247,1162], [1244,1159], [1241,1156], [1237,1153], [1234,1150], [1231,1147], [1227,1144], [1224,1141], [1221,1138], [1217,1134], [1214,1131], [1211,1128], [1207,1125], [1204,1122], [1201,1119], [1198,1116], [1194,1113], [1191,1110], [1188,1107], [1185,1104], [1182,1101], [1178,1098], [1175,1095], [1172,1092], [1169,1089], [1166,1086], [1162,1083], [1159,1080], [1156,1078], [1153,1075], [1150,1072], [1147,1069], [1144,1066], [1141,1063], [1138,1060], [1134,1057], [1131,1054], [1128,1052], [1125,1049], [1122,1046], [1119,1043], [1116,1040], [1113,1037], [1110,1035], [1107,1032], [1104,1029], [1101,1026], [1098,1024], [1095,1021], [1092,1018], [1089,1015], [1086,1012], [1083,1010], [1080,1007], [1078,1004], [1075,1002], [1072,999], [1069,996], [1066,993], [1063,991], [1060,988], [1057,985], [1054,983], [1052,980], [1049,977], [1046,975], [1043,972], [1040,970], [1037,967], [1035,964], [1032,962], [1029,959], [1026,956], [1024,956], [1021,951], [1018,949], [1015,946], [1012,944], [1010,941], [1007,939], [1004,936], [1002,933], [999,931], [996,928], [993,926], [991,923], [988,921], [985,918], [983,916], [980,913], [977,911], [975,908], [972,906], [970,904], [967,901], [964,899], [962,896], [959,894], [956,891], [954,889], [951,887], [949,884], [946,882], [944,879], [941,877], [939,875], [936,872], [933,870], [931,868], [928,865], [926,863], [923,861], [921,858], [918,856], [916,854], [913,851], [911,849], [908,847], [906,844], [904,842], [901,840], [899,838], [896,835], [894,833], [891,831], [889,829], [887,826], [884,824], [882,822], [879,820], [877,817], [875,815], [872,813], [870,811], [868,809], [865,806], [863,804], [861,802], [858,800], [856,798], [854,796], [851,793], [849,791], [847,789], [844,787], [842,785], [840,783], [838,781], [835,778], [833,776], [831,774], [829,772], [826,770], [824,768], [822,766], [820,764], [817,762], [815,760], [813,758], [811,756], [809,754], [806,752], [804,750], [802,747], [800,745], [798,743], [796,741], [793,739], [791,737], [789,735], [787,733], [785,731], [783,729], [781,728], [778,726], [776,724], [774,722], [772,720], [770,718], [768,716], [766,714], [764,712], [762,710], [760,708], [758,706], [756,704], [754,702], [752,700], [750,699], [747,697], [745,695], [743,693], [741,691], [739,689], [737,687], [735,685], [733,684], [731,682], [729,680], [728,678], [726,676], [724,674], [722,673], [720,671], [718,669], [716,667], [714,665], [712,663], [710,662], [708,660], [706,658], [704,656], [702,655], [700,653], [699,651], [697,649], [695,647], [693,646], [691,644], [689,642], [687,641], [685,639], [684,637], [682,635], [680,634], [678,632], [676,630], [674,628], [673,627], [671,625], [669,623], [667,622], [665,620], [663,618], [662,617], [660,615], [658,613], [656,612], [655,610], [653,608], [651,607], [649,605], [647,603], [646,602], [644,600], [642,599], [641,597], [639,595], [637,594], [635,592], [634,591], [632,589], [630,587], [628,586], [627,584], [625,583], [623,581], [622,579], [620,578], [618,576], [617,575], [615,573], [613,572], [612,570], [610,569], [608,567], [607,565], [605,564], [603,562], [602,561], [600,559], [599,558], [597,556], [595,555], [594,553], [592,552], [591,550], [589,549], [587,547], [586,546], [584,544], [583,543], [581,541], [579,540], [578,539], [576,537], [575,536], [573,534], [572,533], [570,531], [569,530], [567,528], [565,527], [564,526], [562,524], [561,523], [559,521], [558,520], [556,518], [555,517], [553,516], [552,514], [550,513], [549,512], [547,510], [546,509], [544,507], [543,506], [541,505], [540,503], [539,502], [537,501], [536,499], [534,498], [533,496], [531,495], [530,494], [528,492], [527,491], [526,490], [524,488], [523,487], [521,486], [520,485], [518,483], [517,482], [516,481], [514,479], [513,478], [512,478], [510,475], [509,474], [507,473], [506,472], [505,470], [503,469], [502,468], [501,466], [499,465], [498,464], [496,463], [495,461], [494,460], [492,459], [491,458], [490,456], [488,455], [487,454], [486,453], [485,452], [483,450], [482,449], [481,448], [479,447], [478,445], [477,444], [475,443], [474,442], [473,441], [472,439], [470,438], [469,437], [468,436], [466,435], [465,434], [464,432], [463,431], [461,430], [460,429], [459,428], [458,427], [456,425], [455,424], [454,423], [453,422], [452,421], [450,420], [449,419], [448,417], [447,416], [445,415], [444,414], [443,413], [442,412], [441,411], [439,410], [438,408], [437,407], [436,406], [435,405], [434,404], [432,403], [431,402], [430,401], [429,400], [428,399], [427,398], [425,396], [424,395], [423,394], [422,393], [421,392], [420,391], [419,390], [417,389], [416,388], [415,387], [414,386], [413,385], [412,384], [411,383], [410,382], [408,381], [407,380], [406,379], [405,378], [404,377], [403,376], [402,375], [401,373], [400,372], [399,371], [398,370], [396,369], [395,368], [394,367], [393,366], [392,365], [391,364], [390,364], [389,363], [388,362], [387,361], [386,360], [385,359], [384,358], [383,357], [382,356], [381,355], [380,354], [379,353], [378,352], [377,351], [376,350], [375,349], [373,348], [372,347], [371,346], [370,345], [369,344], [368,343], [367,342], [366,342], [365,341], [364,339], [363,338], [362,337], [361,336], [360,335], [359,334], [358,333], [357,332], [356,331], [355,331], [354,330], [353,329], [352,328], [351,327], [350,326], [349,325], [348,324], [347,323], [346,323], [345,322], [344,321], [343,320], [342,318], [341,317], [340,317], [339,316], [338,315], [337,314], [336,313], [335,312], [334,311], [333,311], [332,310], [331,308], [330,307], [329,306], [328,306], [327,305], [326,304], [325,303], [324,302], [323,301], [322,300], [321,299], [320,298], [319,297], [318,297], [317,295], [316,294], [315,293], [314,293], [313,292], [312,291], [311,289], [310,289], [308,287], [307,286], [306,285], [305,284], [304,283], [303,282], [302,282], [301,280], [300,279], [299,279], [298,278], [297,276], [296,276], [295,275], [294,274], [293,273], [292,272], [291,271], [290,270], [289,269], [288,268], [287,268], [286,266], [285,265], [284,265], [283,264], [282,263], [280,261], [279,260], [278,259], [277,258], [276,257], [275,256], [274,256], [273,254], [272,253], [271,253], [270,251], [269,251], [268,249], [266,248], [265,247], [264,246], [263,245], [261,243], [260,242], [259,241], [258, 240], [257,239], [256,239], [255,237], [254,237], [253,236], [251,234], [249,232], [248,231], [247,230], [246,229], [245,228], [244,227], [243,226], [242,226], [241,224], [240, 224], [239,222], [238,222], [237,221], [236,219], [234,218], [233,217], [232,216], [231,215], [230,214], [229,213], [228,212], [227,211], [226,210], [225,210], [224,208], [223,208], [222,207], [221,206], [219,204], [218,203], [217,202], [216,201], [215,200], [214,199], [213,199], [212,197], [211,196], [210,195], [209,195], [208,194], [207,193], [206,192], [205,191], [204,190], [203,189], [202,188], [201,187], [200,186], [199,185], [197,183], [196,182], [195,182], [194,181]];
    TRUE_ZOOM_OUT : TRSZoomLevelArray = [[181,193], [182,194], [183,195], [185,197], [186,199], [187, 200], [188,200], [189,201], [190,202], [191,203], [192,205], [193,206], [194,207], [195,208], [196,209], [197,210], [199,212], [200,213], [201,214], [202,215], [203,217], [204,218], [205,218], [206,219], [207,221], [208,222], [209,223], [210,224], [211,225], [212,226], [213,227], [214,228], [215,229], [216,230], [217,231], [218,232], [219,234], [221,236], [222,237], [223,238], [224,239], [225,240], [226,241], [227,242], [228,243], [229,244], [230,245], [231,247], [232,247], [234,249], [236,251], [237,253], [238,254], [239,255], [240,256], [241,257], [242,258], [243,259], [244,260], [245,261], [246,263], [247,263], [248,265], [249,265], [251,268], [253,270], [254,271], [255,272], [256,273], [257,274], [258,275], [259,276], [260,277], [261,279], [263,280], [264,282], [265,282], [266,284], [268,286], [269,287], [270,288], [271,289], [272,290], [273,291], [274,293], [275,293], [276,294], [277,296], [278,297], [279,297], [280,299], [282,301], [283,302], [284,303], [285, 304], [286,305], [287,306], [288,307], [289,308], [290,310], [291,311], [292,311], [293,312], [294,314], [295,315], [296,316], [297,317], [298,318], [299,319], [300,320], [301,321], [302,323], [303,323], [304,324], [305,325], [306,326], [307,328], [308,329], [310,331], [311,331], [312,333], [313,334], [314,335], [315,336], [316,337], [317,338], [318,340], [319,341], [320,342], [321,342], [322,343], [323,344], [324,346], [325,347], [326,348], [327,349], [328,350], [329,351], [330,352], [331,353], [332,355], [333,356], [334,357], [335,358], [336,359], [337,360], [338,361], [339,362], [340,363], [341,364], [342,364], [343,366], [344,367], [345,368], [346,369], [347,370], [348,371], [349,372], [350,373], [351,375], [352,376], [353,377], [354,378], [355,379], [356,380], [357,381], [358,382], [359,383], [360,384], [361,385], [362,386], [363,387], [364,388], [365,390], [366,391], [367,392], [368,393], [369,394], [370,395], [371,396], [372,398], [373,399], [375,400], [376,401], [377,402], [378,403], [379,404], [380,405], [381,406], [382,407], [383,408], [384,410], [385,411], [386,412], [387,413], [388,414], [389,415], [390,416], [391,417], [392,419], [393,420], [394, 421], [395,422], [396,423], [398,424], [399,425], [400,427], [401,428], [402,429], [403, 430], [404,431], [405,432], [406,434], [407,435], [408,436], [410,437], [411,438], [412,439], [413,441], [414,442], [415,443], [416,444], [417,445], [419,447], [420,448], [421,449], [422,450], [423,452], [424,453], [425,454], [427,455], [428,456], [429,458], [430,459], [431,460], [432,461], [434,463], [435,464], [436,465], [437,466], [438,468], [439,469], [441,470], [442,472], [443,473], [444,474], [445,475], [447,477], [448,478], [449,479], [450,481], [452,482], [453,483], [454,485], [455,486], [456,487], [458,488], [459,490], [460,491], [461,492], [463,494], [464,495], [465,496], [466,498], [468,499], [469,501], [470,502], [472,503], [473,505], [474,506], [475,507], [477,509], [478,510], [479,512], [481,513], [482,514], [483,516], [485,517], [486,518], [487,520], [488,521], [490,523], [491,524], [492,526], [494,527], [495,528], [496,530], [498,531], [499,533], [501,534], [502,536], [503,537], [505,539], [506,540], [507,541], [509,543], [510,544], [512,547], [513,547], [514,549], [516,550], [517,552], [518,553], [520,555], [521,556], [523,558], [524,559], [526,561], [527,562], [528,564], [530,565], [531,567], [533,569], [534,570], [536,572], [537,573], [539,575], [540,576], [541,578], [543,579], [544,581], [546,583], [547,584], [549,586], [550,587], [552,589], [553,591], [555,592], [556,594], [558,595], [559,597], [561,599], [562,600], [564,602], [565,603], [567,605], [569,607], [570,608], [572,610], [573,612], [575,613], [576,615], [578,617], [579,618], [581,620], [583,622], [584,623], [586,625], [587,627], [589,628], [591,630], [592,632], [594,634], [595,635], [597,637], [599,639], [600,641], [602,642], [603,644], [605,646], [607,647], [608,649], [610,651], [612,653], [613,655], [615,656], [617,658], [618,660], [620,662], [622,663], [623,665], [625,667], [627,669], [628,671], [630,673], [632,674], [634,676], [635,678], [637,680], [639,682], [641,684], [642,685], [644,687], [646,689], [647,691], [649,693], [651,695], [653,697], [655,699], [656,700], [658,702], [660,704], [662,706], [663,708], [665,710], [667,712], [669,714], [671,716], [673,718], [674,720], [676,722], [678,724], [680,726], [682,728], [684,729], [685,731], [687,733], [689,735], [691,737], [693,739], [695,741], [697,743], [699,745], [700,747], [702,750], [704,752], [706,754], [708,756], [710,758], [712,760], [714,762], [716,764], [718,766], [720,768], [722,770], [724,772], [726,774], [728,776], [729,778], [731,781], [733,783], [735,785], [737,787], [739,789], [741,791], [743,793], [745,796], [747,798], [750,800], [752,802], [754,804], [756,806], [758,809], [760,811], [762,813], [764,815], [766,817], [768,820], [770,822], [772,824], [774,826], [776,829], [778,831], [781,833], [783,835], [785,838], [787,840], [789,842], [791,844], [793,847], [796,849], [798,851], [800,854], [802,856], [804,858], [806,861], [809,863], [811,865], [813,868], [815,870], [817,872], [820,875], [822,877], [824,879], [826,882], [829,884], [831,887], [833,889], [835,891], [838,894], [840,896], [842,899], [844,901], [847,904], [849,906], [851,908], [854,911], [856,913], [858,916], [861,918], [863,921], [865,923], [868,926], [870,928], [872,931], [875,933], [877,936], [879,939], [882,941], [884,944], [887,946], [889,949], [891,951], [894,954], [896,956], [899,959], [901,962], [904,964], [906,967], [908,970], [911,972], [913,975], [916,977], [918,980], [921,983], [923,985], [926,988], [928,991], [931,993], [933,996], [936,999], [939,1002], [941,1004], [944,1007], [946,1010], [949,1012], [951,1015], [954,1018], [956,1021], [959,1024], [962,1026], [964,1029], [967,1032], [970,1035], [972,1037], [975,1040], [977,1043], [980,1046], [983,1049], [985,1052], [988,1054], [991,1057], [993,1060], [996,1063], [999,1066], [1002,1069], [1004,1072], [1007,1075], [1010,1078], [1012,1080], [1015,1083], [1018,1086], [1021,1089], [1024,1095], [1026,1095], [1029,1098], [1032,1101], [1035,1104], [1037,1107], [1040,1110], [1043,1113], [1046,1116], [1049,1119], [1052,1122], [1054,1125], [1057,1128], [1060,1131], [1063,1134], [1066,1138], [1069,1141], [1072,1144], [1075,1147], [1078,1150], [1080,1153], [1083,1156], [1086,1159], [1089,1162], [1092,1166], [1095,1169], [1098,1172], [1101,1175], [1104,1178], [1107,1182], [1110,1185], [1113,1188], [1116,1191], [1119,1194], [1122,1198], [1125,1201], [1128,1204], [1131,1207], [1134,1211], [1138,1214], [1141,1217], [1144,1221], [1147,1224], [1150,1227], [1153,1231], [1156,1234], [1159,1237], [1162,1241], [1166,1244], [1169,1247], [1172,1251], [1175,1254], [1178,1257], [1182,1261], [1185,1264], [1188,1268], [1191,1271], [1194,1275], [1198,1278], [1201,1282], [1204,1285], [1207,1288], [1211,1292], [1214,1295], [1217,1299], [1221,1303], [1224,1306], [1227,1310], [1231,1313], [1234,1317], [1237,1320], [1241,1324], [1244,1327], [1247,1331], [1251,1335], [1254,1338], [1257,1342], [1261,1346], [1264,1349], [1268,1353], [1271,1357], [1275,1360], [1278,1364], [1282,1368], [1285,1371], [1288,1375], [1292,1379], [1295,1383], [1299,1386], [1303,1390], [1306,1394], [1310,1398], [1313,1401], [1317,1405], [1320,1409], [1324,1413], [1327,1417], [1331,1420], [1335,1424], [1338,1428], [1342,1432], [1346,1436], [1349,1440], [1353,1444], [1357,1448]];
    TRUE_TO_SLIDER: array of TRSZoomToSlider = [[181,0], [182,0], [183,0], [184,1], [185,1], [186,1], [187,1], [188,1], [189,2], [190,2], [191,2], [192,2], [193,3], [194,3], [195,3], [196,3], [197,4], [198,4], [199,4], [200,4], [201,5], [202,5], [203,5], [204,5], [205,5], [206,6], [207,6], [208,6], [209,6], [210,7], [211,7], [212,7], [213,7], [214,7], [215,8], [216,8], [217,8], [218,8], [219,9], [220,9], [221,9], [222,9], [223,9], [224,10], [225,10], [226,10], [227,10], [228,10], [229,11], [230,11], [231,11], [232,11], [233,11], [234,11], [235,12], [236,12], [237,12], [238,12], [239,14], [240,14], [241,14], [242,14], [243,14], [244,14], [245,15], [246,15], [247,15], [248,15], [249,15], [250,16], [251,16], [252,16], [253,16], [254,16], [255,16], [256,17], [257,17], [258,17], [259,17], [260,17], [261,18], [262,18], [263,18], [264,18], [265,18], [266,18], [267,19], [268,19], [269,19], [270,19], [271,19], [272,19], [273,20], [274,20], [275,20], [276,20], [277,20], [278,20], [279,21], [280,21], [281,21], [282,21], [283,21], [284,21], [285,22], [286,22], [287,22], [288,22], [289,22], [290,22], [291,23], [292,23], [293,23], [294,23], [295,23], [296,23], [297,24], [298,24], [299,24], [300,24], [301,24], [302,24], [303,24], [304,25], [305,25], [306,25], [307,25], [308,25], [309,25], [310,25], [311,26], [312,26], [313,26], [314,26], [315,26], [316,26], [317,26], [318,27], [319,27], [320,27], [321,27], [322,27], [323,27], [324,28], [325,28], [326,28], [327,28], [328,28], [329,28], [330,28], [331,29], [332,29], [333,29], [334,29], [335,29], [336,29], [337,29], [338,29], [339,30], [340,30], [341,30], [342,30], [343,30], [344,30], [345,30], [346,31], [347,31], [348,31], [349,31], [350,31], [351,31], [352,31], [353,31], [354,32], [355,32], [356,32], [357,32], [358,32], [359,32], [360,32], [361,32], [362,33], [363,33], [364,33], [365,33], [366,33], [367,33], [368,33], [369,34], [370,34], [371,34], [372,34], [373,34], [374,34], [375,34], [376,34], [377,34], [378,35], [379,35], [380,35], [381,35], [382,35], [383,35], [384,35], [385,35], [386,36], [387,36], [388,36], [389,36], [390,36], [391,36], [392,36], [393,36], [394,38], [395,38], [396,38], [397,38], [398,38], [399,38], [400,38], [401,38], [402,38], [403,39], [404,39], [405,39], [406,39], [407,39], [408,39], [409,39], [410,39], [411,39], [412,40], [413,40], [414,40], [415,40], [416,40], [417,40], [418,40], [419,40], [420,40], [421,41], [422,41], [423,41], [424,41], [425,41], [426,41], [427,41], [428,41], [429,41], [430,42], [431,42], [432,42], [433,42], [434,42], [435,42], [436,42], [437,42], [438,42], [439,43], [440,43], [441,43], [442,43], [443,43], [444,43], [445,43], [446,43], [447,43], [448,43], [449,44], [450,44], [451,44], [452,44], [453,44], [454,44], [455,44], [456,44], [457,44], [458,44], [459,45], [460,45], [461,45], [462,45], [463,45], [464,45], [465,45], [466,45], [467,45], [468,45], [469,46], [470,46], [471,46], [472,46], [473,46], [474,46], [475,46], [476,46], [477,46], [478,46], [479,47], [480,47], [481,47], [482,47], [483,47], [484,47], [485,47], [486,47], [487,47], [488,47], [489,48], [490,48], [491,48], [492,48], [493,48], [494,48], [495,48], [496,48], [497,48], [498,48], [499,48], [501,49], [502,49], [503,49], [504,49], [505,49], [506,49], [507,49], [508,49], [509,49], [510,49], [512,50], [513,50], [514,50], [515,50], [516,50], [517,50], [518,50], [519,50], [520,50], [521,50], [523,51], [524,51], [525,51], [526,51], [527,51], [528,51], [529,51], [530,51], [531,51], [532,51], [533,51], [534,52], [535,52], [536,52], [537,52], [538,52], [539,52], [540,52], [541,52], [542,52], [543,52], [544,52], [546,53], [547,53], [548,53], [549,53], [550,53], [551,53], [552,53], [553,53], [554,53], [555,53], [556,53], [558,54], [559,54], [560,54], [561,54], [562,54], [563,54], [564,54], [565,54], [566,54], [567,54], [568,54], [569,54], [570,55], [571,55], [572,55], [573,55], [574,55], [575,55], [576,55], [577,55], [578,55], [579,55], [580,55], [581,55], [583,56], [584,56], [585,56], [586,56], [587,56], [588,56], [589,56], [590,56], [591,56], [592,56], [593,56], [594,56], [595,57], [596,57], [597,57], [598,57], [599,57], [600,57], [601,57], [602,57], [603,57], [604,57], [605,57], [606,57], [607,57], [608,58], [609,58], [610,58], [611,58], [612,58], [613,58], [614,58], [615,58], [616,58], [617,58], [618,58], [619,58], [620,58], [622,59], [623,59], [624,59], [625,59], [626,59], [627,59], [628,59], [629,59], [630,59], [631,59], [632,59], [633,59], [634,59], [635,60], [636,60], [637,60], [638,60], [639,60], [640,60], [641,60], [642,60], [643,60], [644,60], [645,60], [646,60], [647,60], [649,61], [650,61], [651,61], [652,61], [653,61], [654,61], [655,61], [656,61], [657,61], [658,61], [659,61], [660,61], [661,61], [662,61], [663,62], [664,62], [665,62], [666,62], [667,62], [668,62], [669,62], [670,62], [671,62], [672,62], [673,62], [674,62], [675,62], [676,62], [678,64], [679,64], [680,64], [681,64], [682,64], [683,64], [684,64], [685,64], [686,64], [687,64], [688,64], [689,64], [690,64], [691,64], [693,65], [694,65], [695,65], [696,65], [697,65], [698,65], [699,65], [700,65], [701,65], [702,65], [703,65], [704,65], [705,65], [706,65], [708,66], [709,66], [710,66], [711,66], [712,66], [713,66], [714,66], [715,66], [716,66], [717,66], [718,66], [719,66], [720,66], [721,66], [722,66], [724,67], [725,67], [726,67], [727,67], [728,67], [729,67], [730,67], [731,67], [732,67], [733,67], [734,67], [735,67], [736,67], [737,67], [739,68], [740,68], [741,68], [742,68], [743,68], [744,68], [745,68], [746,68], [747,68], [748,68], [749,68], [750,68], [751,68], [752,68], [753,68], [754,68], [756,69], [757,69], [758,69], [759,69], [760,69], [761,69], [762,69], [763,69], [764,69], [765,69], [766,69], [767,69], [768,69], [769,69], [770,69], [772,70], [773,70], [774,70], [775,70], [776,70], [777,70], [778,70], [779,70], [780,70], [781,70], [782,70], [783,70], [784,70], [785,70], [786,70], [787,70], [789,71], [790,71], [791,71], [792,71], [793,71], [794,71], [795,71], [796,71], [797,71], [798,71], [799,71], [800,71], [801,71], [802,71], [803,71], [804,71], [806,72], [807,72], [808,72], [809,72], [810,72], [811,72], [812,72], [813,72], [814,72], [815,72], [816,72], [817,72], [818,72], [819,72], [820,72], [821,72], [822,72], [824,73], [825,73], [826,73], [827,73], [828,73], [829,73], [830,73], [831,73], [832,73], [833,73], [834,73], [835,73], [836,73], [837,73], [838,73], [839,73], [840,73], [842,74], [843,74], [844,74], [845,74], [846,74], [847,74], [848,74], [849,74], [850,74], [851,74], [852,74], [853,74], [854,74], [855,74], [856,74], [857,74], [858,74], [861,75], [862,75], [863,75], [864,75], [865,75], [866,75], [867,75], [868,75], [869,75], [870,75], [871,75], [872,75], [873,75], [874,75], [875,75], [876,75], [877,75], [879,76], [880,76], [881,76], [882,76], [883,76], [884,76], [885,76], [886,76], [887,76], [888,76], [889,76], [890,76], [891,76], [892,76], [893,76], [894,76], [895,76], [896,76], [899,77], [900,77], [901,77], [902,77], [903,77], [904,77], [905,77], [906,77], [907,77], [908,77], [909,77], [910,77], [911,77], [912,77], [913,77], [914,77], [915,77], [916,77], [918,78], [919,78], [920,78], [921,78], [922,78], [923,78], [924,78], [925,78], [926,78], [927,78], [928,78], [929,78], [930,78], [931,78], [932,78], [933,78], [934,78], [935,78], [936,78], [939,79], [940,79], [941,79], [942,79], [943,79], [944,79], [945,79], [946,79], [947,79], [948,79], [949,79], [950,79], [951,79], [952,79], [953,79], [954,79], [955,79], [956,79], [959,80], [960,80], [961,80], [962,80], [963,80], [964,80], [965,80], [966,80], [967,80], [968,80], [969,80], [970,80], [971,80], [972,80], [973,80], [974,80], [975,80], [976,80], [977,80], [980,81], [981,81], [982,81], [983,81], [984,81], [985,81], [986,81], [987,81], [988,81], [989,81], [990,81], [991,81], [992,81], [993,81], [994,81], [995,81], [996,81], [997,81], [998,81], [999,81], [1002,82], [1003,82], [1004,82], [1005,82], [1006,82], [1007,82], [1008,82], [1009,82], [1010,82], [1011,82], [1012,82], [1013,82], [1014,82], [1015,82], [1016,82], [1017,82], [1018,82], [1019,82], [1020,82], [1021,82], [1024,83], [1025,83], [1026,83], [1027,83], [1028,83], [1029,83], [1030,83], [1031,83], [1032,83], [1033,83], [1034,83], [1035,83], [1036,83], [1037,83], [1038,83], [1039,83], [1040,83], [1041,83], [1042,83], [1043,83], [1046,84], [1047,84], [1048,84], [1049,84], [1050,84], [1051,84], [1052,84], [1053,84], [1054,84], [1055,84], [1056,84], [1057,84], [1058,84], [1059,84], [1060,84], [1061,84], [1062,84], [1063,84], [1064,84], [1065,84], [1066,84], [1069,85], [1070,85], [1071,85], [1072,85], [1073,85], [1074,85], [1075,85], [1076,85], [1077,85], [1078,85], [1079,85], [1080,85], [1081,85], [1082,85], [1083,85], [1084,85], [1085,85], [1086,85], [1087,85], [1088,85], [1089,85], [1092,86], [1093,86], [1094,86], [1095,86], [1096,86], [1097,86], [1098,86], [1099,86], [1100,86], [1101,86], [1102,86], [1103,86], [1104,86], [1105,86], [1106,86], [1107,86], [1108,86], [1109,86], [1110,86], [1111,86], [1112,86], [1113,86], [1116,88], [1117,88], [1118,88], [1119,88], [1120,88], [1121,88], [1122,88], [1123,88], [1124,88], [1125,88], [1126,88], [1127,88], [1128,88], [1129,88], [1130,88], [1131,88], [1132,88], [1133,88], [1134,88], [1135,88], [1136,88], [1137,88], [1138,88], [1141,89], [1142,89], [1143,89], [1144,89], [1145,89], [1146,89], [1147,89], [1148,89], [1149,89], [1150,89], [1151,89], [1152,89], [1153,89], [1154,89], [1155,89], [1156,89], [1157,89], [1158,89], [1159,89], [1160,89], [1161,89], [1162,89], [1166,90], [1167,90], [1168,90], [1169,90], [1170,90], [1171,90], [1172,90], [1173,90], [1174,90], [1175,90], [1176,90], [1177,90], [1178,90], [1179,90], [1180,90], [1181,90], [1182,90], [1183,90], [1184,90], [1185,90], [1186,90], [1187,90], [1188,90], [1191,91], [1192,91], [1193,91], [1194,91], [1195,91], [1196,91], [1197,91], [1198,91], [1199,91], [1200,91], [1201,91], [1202,91], [1203,91], [1204,91], [1205,91], [1206,91], [1207,91], [1208,91], [1209,91], [1210,91], [1211,91], [1212,91], [1213,91], [1214,91], [1217,92], [1218,92], [1219,92], [1220,92], [1221,92], [1222,92], [1223,92], [1224,92], [1225,92], [1226,92], [1227,92], [1228,92], [1229,92], [1230,92], [1231,92], [1232,92], [1233,92], [1234,92], [1235,92], [1236,92], [1237,92], [1238,92], [1239,92], [1240,92], [1241,92], [1244,93], [1245,93], [1246,93], [1247,93], [1248,93], [1249,93], [1250,93], [1251,93], [1252,93], [1253,93], [1254,93], [1255,93], [1256,93], [1257,93], [1258,93], [1259,93], [1260,93], [1261,93], [1262,93], [1263,93], [1264,93], [1265,93], [1266,93], [1267,93], [1268,93], [1271,94], [1272,94], [1273,94], [1274,94], [1275,94], [1276,94], [1277,94], [1278,94], [1279,94], [1280,94], [1281,94], [1282,94], [1283,94], [1284,94], [1285,94], [1286,94], [1287,94], [1288,94], [1289,94], [1290,94], [1291,94], [1292,94], [1293,94], [1294,94], [1295,94], [1299,95], [1300,95], [1301,95], [1302,95], [1303,95], [1304,95], [1305,95], [1306,95], [1307,95], [1308,95], [1309,95], [1310,95], [1311,95], [1312,95], [1313,95], [1314,95], [1315,95], [1316,95], [1317,95], [1318,95], [1319,95], [1320,95], [1321,95], [1322,95], [1323,95], [1324,95], [1327,96], [1328,96], [1329,96], [1330,96], [1331,96], [1332,96], [1333,96], [1334,96], [1335,96], [1336,96], [1337,96], [1338,96], [1339,96], [1340,96], [1341,96], [1342,96], [1343,96], [1344,96], [1345,96], [1346,96], [1347,96], [1348,96], [1349,96], [1350,96], [1351,96], [1352,96], [1353,96], [1357,97], [1358,97], [1359,97], [1360,97], [1361,97], [1362,97], [1363,97], [1364,97], [1365,97], [1366,97], [1367,97], [1368,97], [1369,97], [1370,97], [1371,97], [1372,97], [1373,97], [1374,97], [1375,97], [1376,97], [1377,97], [1378,97], [1379,97], [1380,97], [1381,97], [1382,97], [1383,97], [1386,98], [1387,98], [1388,98], [1389,98], [1390,98], [1391,98], [1392,98], [1393,98], [1394,98], [1395,98], [1396,98], [1397,98], [1398,98], [1399,98], [1400,98], [1401,98], [1402,98], [1403,98], [1404,98], [1405,98], [1406,98], [1407,98], [1408,98], [1409,98], [1410,98], [1411,98], [1412,98], [1413,98], [1417,99], [1418,99], [1419,99], [1420,99], [1421,99], [1422,99], [1423,99], [1424,99], [1425,99], [1426,99], [1427,99], [1428,99], [1429,99], [1430,99], [1431,99], [1432,99], [1433,99], [1434,99], [1435,99], [1436,99], [1437,99], [1438,99], [1439,99], [1440,99], [1441,99], [1442,99], [1443,99], [1444,99], [1448,100]];
  end;

function TRSZoomLevelArray.GetNext(value: Double): Double;
var
  i: Int32;
  z: TRSZoomLevel;
begin
  z := Self.Last();

  if ((Self.First().Start < z.Start) and (value >= z.Start)) or
     ((Self.First().Start > z.Start) and (value <= z.Start)) then
    Exit(z.Stop);

  for i := 0 to High(Self) - 1 do //-1 because it's already checked in the previous if statement.
    if value = Self[i].Start then
      Exit(Self[i].Stop);
end;

function TRSZoom.GetSlider(value: Double = -1): Int32;
var
  i: Int32;
begin
  Result := -1;

  if value < 0 then
    value := Self.TrueZoomLevel;

  for i := 0 to High(Self.TRUE_TO_SLIDER) do
    if value = Self.TRUE_TO_SLIDER[i].TrueZoom then
      Exit(Self.TRUE_TO_SLIDER[i].Slider);

  TerminateScript('Missing zoom level: [' + ToString(value) + ',' + ToString(Options.GetZoomLevel()) + '], Please give this message to Torwent.');
end;

procedure TRSZoom.DrawGraph();
var
  bmp: TMufasaBitmap;
begin
  bmp := TMufasaBitmap.Create(1500, 1500);
  bmp.DrawTPA(TPointArray(Self.TRUE_ZOOM_IN), $00FFFF);
  bmp.DrawTPA(TPointArray(Self.TRUE_ZOOM_OUT), $FF00FF);
  bmp.DrawTPA(TPointArray(Self.TRUE_TO_SLIDER), $FFFFFF);
  bmp.Show(True);
  bmp.Free();
end;

var
  RSZoom: TRSZoom;

begin
  RSZoom.DrawGraph();
end;
